  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/sql/elements.py", line 527, in _execute_on_connection
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
    return connection._execute_clauseelement(
    return await wrapped()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1641, in _execute_clauseelement
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/dispatcher.py", line 283, in _listen_update
    ret = self._execute_context(
    return await self.propagate_event(update_type=update_type, event=event, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1846, in _execute_context
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
    return self._exec_single_context(
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 189, in _propagate_event
    response = await router.propagate_event(update_type=update_type, event=event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 161, in propagate_event
    return await observer.wrap_outer_middleware(_wrapped, event=event, data=kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 153, in _wrapped
    return await self._propagate_event(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/router.py", line 181, in _propagate_event
    response = await observer.trigger(event, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/event/telegram.py", line 126, in trigger
    return await wrapped_inner(event, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/aiogram/dispatcher/event/handler.py", line 71, in call
    return await wrapped()
           ^^^^^^^^^^^^^^^
  File "/app/src/bot/handlers/supervisor.py", line 240, in process_subcontractor_selection
    job = await JobService.create_job(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/app/src/bot/services/jobs.py", line 36, in create_job
    await session.commit()
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py", line 1000, in commit
    await greenlet_spawn(self.sync_session.commit)
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 203, in greenlet_spawn
    result = context.switch(value)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/orm/session.py", line 2030, in commit
    trans.commit(_to_root=True)
  File "<string>", line 2, in commit
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/orm/state_changes.py", line 137, in _go
    ret_value = fn(self, *arg, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1986, in _exec_single_context
    self._handle_dbapi_exception(
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 2363, in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/base.py", line 1967, in _exec_single_context
    self.dialect.do_execute(
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/engine/default.py", line 952, in do_execute
    cursor.execute(statement, parameters)
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 585, in execute
    self._adapt_connection.await_(
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 132, in await_only
    return current.parent.switch(awaitable)  # type: ignore[no-any-return,attr-defined] # noqa: E501
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py", line 196, in greenlet_spawn
    value = await result
            ^^^^^^^^^^^^
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 563, in _prepare_and_execute
    self._handle_exception(error)
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 513, in _handle_exception
    self._adapt_connection._handle_exception(error)
  File "/opt/venv/lib/python3.12/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py", line 797, in _handle_exception
    raise translated_error from error
sqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column "rating" of relation "jobs" does not exist
[SQL: INSERT INTO jobs (title, description, address, job_type, preset_price, status, team_id, supervisor_id, subcontractor_id, accepted_quote_id, photos, decline_reason, rating, rating_comment, reminder_sent, reminder_sent_at, created_at, sent_at, accepted_at, started_at, completed_at, cancelled_at, archived_at) VALUES ($1::VARCHAR, $2::VARCHAR, $3::VARCHAR, $4::jobtype, $5::VARCHAR, $6::jobstatus, $7::INTEGER, $8::INTEGER, $9::INTEGER, $10::INTEGER, $11::VARCHAR, $12::VARCHAR, $13::INTEGER, $14::VARCHAR, $15::BOOLEAN, $16::TIMESTAMP WITHOUT TIME ZONE, $17::TIMESTAMP WITHOUT TIME ZONE, $18::TIMESTAMP WITHOUT TIME ZONE, $19::TIMESTAMP WITHOUT TIME ZONE, $20::TIMESTAMP WITHOUT TIME ZONE, $21::TIMESTAMP WITHOUT TIME ZONE, $22::TIMESTAMP WITHOUT TIME ZONE, $23::TIMESTAMP WITHOUT TIME ZONE) RETURNING jobs.id]
[parameters: ('Python development', 'Write a program that checks user info and take it into database', 'Anywhere in the world', 'PRESET_PRICE', '$1000', 'CREATED', 1, 1, None, None, None, None, None, None, False, None, datetime.datetime(2026, 1, 9, 14, 21, 57, 926899), None, None, None, None, None, None)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2026-01-09 14:21:58,020 - aiogram.event - INFO - Update id=259322664 is handled. Duration 95 ms by bot id=8551802921
2026-01-09 14:22:07,354 - src.bot.services.scheduler - ERROR - Scheduler error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column jobs.rating does not exist
[SQL: SELECT jobs.id, jobs.title, jobs.description, jobs.address, jobs.job_type, jobs.preset_price, jobs.status, jobs.team_id, jobs.supervisor_id, jobs.subcontractor_id, jobs.accepted_quote_id, jobs.photos, jobs.decline_reason, jobs.rating, jobs.rating_comment, jobs.reminder_sent, jobs.reminder_sent_at, jobs.created_at, jobs.sent_at, jobs.accepted_at, jobs.started_at, jobs.completed_at, jobs.cancelled_at, jobs.archived_at, users.id AS id_1, users.telegram_id, users.username, users.first_name, users.role, users.team_id AS team_id_1, users.access_code_id, users.is_active, users.availability_status, users.created_at AS created_at_1 
FROM jobs JOIN users ON jobs.subcontractor_id = users.id 
WHERE jobs.status = $1::jobstatus AND jobs.sent_at < $2::TIMESTAMP WITHOUT TIME ZONE AND jobs.reminder_sent = false AND jobs.subcontractor_id IS NOT NULL]
[parameters: ('SENT', datetime.datetime(2026, 1, 8, 14, 22, 7, 309219))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2026-01-09 14:23:07,430 - src.bot.services.scheduler - ERROR - Scheduler error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column jobs.rating does not exist
[SQL: SELECT jobs.id, jobs.title, jobs.description, jobs.address, jobs.job_type, jobs.preset_price, jobs.status, jobs.team_id, jobs.supervisor_id, jobs.subcontractor_id, jobs.accepted_quote_id, jobs.photos, jobs.decline_reason, jobs.rating, jobs.rating_comment, jobs.reminder_sent, jobs.reminder_sent_at, jobs.created_at, jobs.sent_at, jobs.accepted_at, jobs.started_at, jobs.completed_at, jobs.cancelled_at, jobs.archived_at, users.id AS id_1, users.telegram_id, users.username, users.first_name, users.role, users.team_id AS team_id_1, users.access_code_id, users.is_active, users.availability_status, users.created_at AS created_at_1 
FROM jobs JOIN users ON jobs.subcontractor_id = users.id 
WHERE jobs.status = $1::jobstatus AND jobs.sent_at < $2::TIMESTAMP WITHOUT TIME ZONE AND jobs.reminder_sent = false AND jobs.subcontractor_id IS NOT NULL]
[parameters: ('SENT', datetime.datetime(2026, 1, 8, 14, 23, 7, 362283))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2026-01-09 14:24:07,478 - src.bot.services.scheduler - ERROR - Scheduler error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column jobs.rating does not exist
[SQL: SELECT jobs.id, jobs.title, jobs.description, jobs.address, jobs.job_type, jobs.preset_price, jobs.status, jobs.team_id, jobs.supervisor_id, jobs.subcontractor_id, jobs.accepted_quote_id, jobs.photos, jobs.decline_reason, jobs.rating, jobs.rating_comment, jobs.reminder_sent, jobs.reminder_sent_at, jobs.created_at, jobs.sent_at, jobs.accepted_at, jobs.started_at, jobs.completed_at, jobs.cancelled_at, jobs.archived_at, users.id AS id_1, users.telegram_id, users.username, users.first_name, users.role, users.team_id AS team_id_1, users.access_code_id, users.is_active, users.availability_status, users.created_at AS created_at_1 
FROM jobs JOIN users ON jobs.subcontractor_id = users.id 
WHERE jobs.status = $1::jobstatus AND jobs.sent_at < $2::TIMESTAMP WITHOUT TIME ZONE AND jobs.reminder_sent = false AND jobs.subcontractor_id IS NOT NULL]
[parameters: ('SENT', datetime.datetime(2026, 1, 8, 14, 24, 7, 433807))]
(Background on this error at: https://sqlalche.me/e/20/f405)
2026-01-09 14:25:07,528 - src.bot.services.scheduler - ERROR - Scheduler error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column jobs.rating does not exist
[SQL: SELECT jobs.id, jobs.title, jobs.description, jobs.address, jobs.job_type, jobs.preset_price, jobs.status, jobs.team_id, jobs.supervisor_id, jobs.subcontractor_id, jobs.accepted_quote_id, jobs.photos, jobs.decline_reason, jobs.rating, jobs.rating_comment, jobs.reminder_sent, jobs.reminder_sent_at, jobs.created_at, jobs.sent_at, jobs.accepted_at, jobs.started_at, jobs.completed_at, jobs.cancelled_at, jobs.archived_at, users.id AS id_1, users.telegram_id, users.username, users.first_name, users.role, users.team_id AS team_id_1, users.access_code_id, users.is_active, users.availability_status, users.created_at AS created_at_1 
FROM jobs JOIN users ON jobs.subcontractor_id = users.id 
WHERE jobs.status = $1::jobstatus AND jobs.sent_at < $2::TIMESTAMP WITHOUT TIME ZONE AND jobs.reminder_sent = false AND jobs.subcontractor_id IS NOT NULL]
[parameters: ('SENT', datetime.datetime(2026, 1, 8, 14, 25, 7, 487455))]
(Background on this error at: https://sqlalche.me/e/20/f405)